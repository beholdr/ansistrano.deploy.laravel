---
app_environment: dev
app_http_user: www-data

app_exclude_paths_add: []
app_exclude_paths:
  - "{{ ansistrano_deploy_from }}/.env"
  - "{{ ansistrano_deploy_from }}/.git"
  - "{{ ansistrano_deploy_from }}/bootstrap/cache"
  - "{{ ansistrano_deploy_from }}/database/*.sqlite*"
  - "{{ ansistrano_deploy_from }}/node_modules"
  - "{{ ansistrano_deploy_from }}/storage"
  - "{{ ansistrano_deploy_from }}/vendor"

app_shared_paths_add: []
app_shared_paths:
  - "{{ ansistrano_deploy_from }}/storage"

app_writable_paths_add: []
app_writable_paths:
  - "{{ ansistrano_deploy_from }}/bootstrap/cache"
  - "{{ ansistrano_deploy_from }}/storage"
  - "{{ ansistrano_deploy_from }}/storage/app"
  - "{{ ansistrano_deploy_from }}/storage/app/public"
  - "{{ ansistrano_deploy_from }}/storage/framework"
  - "{{ ansistrano_deploy_from }}/storage/framework/cache"
  - "{{ ansistrano_deploy_from }}/storage/framework/cache/data"
  - "{{ ansistrano_deploy_from }}/storage/framework/sessions"
  - "{{ ansistrano_deploy_from }}/storage/framework/views"
  - "{{ ansistrano_deploy_from }}/storage/logs"

app_docker_commands_add: []
app_docker_commands:
  - command: composer install --prefer-dist --no-progress --no-interaction --optimize-autoloader --no-dev
    root: true
  - command: composer dump-autoload --classmap-authoritative
    root: true
  - command: php artisan storage:link
    root: true
  - command: php artisan config:cache
  - command: php artisan route:cache
  - command: php artisan view:cache
  - command: php artisan event:cache
  - command: php artisan migrate --force

app_docker_exec: "docker compose exec --user {{ app_http_user }} php sh -c 'cd releases/{{ ansistrano_release_version }} && {{ item.command }}'"
app_docker_exec_as_root: "docker compose exec php sh -c 'cd releases/{{ ansistrano_release_version }} && {{ item.command }}'"
